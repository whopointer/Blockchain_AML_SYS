# åŒºå—é“¾AMLåæ´—é’±æ£€æµ‹ç³»ç»Ÿ

åŸºäºä¸¤é˜¶æ®µDGI+GIN+éšæœºæ£®æ—çš„åŒºå—é“¾äº¤æ˜“å¼‚å¸¸æ£€æµ‹ç³»ç»Ÿ

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®å®ç°äº†ä¸€ä¸ªå…ˆè¿›çš„åŒºå—é“¾åæ´—é’±(AML)æ£€æµ‹ç³»ç»Ÿï¼Œé‡‡ç”¨"ä¸¤é˜¶æ®µ"æ¨¡å‹æ¶æ„ï¼š

**ç¬¬ä¸€é˜¶æ®µ**ï¼šä½¿ç”¨æ·±åº¦å›¾ä¿¡æ¯æœ€å¤§åŒ–(DGI)ç®—æ³•ç»“åˆå›¾åŒæ„ç½‘ç»œ(GIN)ç¼–ç å™¨è¿›è¡Œè‡ªç›‘ç£å­¦ä¹ ï¼Œå­¦ä¹ æ¯”ç‰¹å¸äº¤æ˜“å›¾ä¸­æ¯ä¸ªäº¤æ˜“èŠ‚ç‚¹çš„ä½ç»´åµŒå…¥è¡¨ç¤ºã€‚

**ç¬¬äºŒé˜¶æ®µ**ï¼šå°†å­¦ä¹ åˆ°çš„èŠ‚ç‚¹åµŒå…¥ä¸åŸå§‹ç‰¹å¾æ‹¼æ¥ï¼Œè®­ç»ƒéšæœºæ£®æ—åˆ†ç±»å™¨è¿›è¡Œç›‘ç£çš„å¼‚å¸¸äº¤æ˜“æ£€æµ‹ã€‚

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ ¸å¿ƒæ¨¡å‹æ¶æ„

```
ç¬¬ä¸€é˜¶æ®µï¼šè‡ªç›‘ç£å›¾è¡¨ç¤ºå­¦ä¹ 
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   äº¤æ˜“å›¾æ•°æ®    â”‚â”€â”€â”€â–¶â”‚   GINç¼–ç å™¨      â”‚â”€â”€â”€â–¶â”‚   DGIåˆ¤åˆ«å™¨     â”‚
â”‚ (èŠ‚ç‚¹+è¾¹+ç‰¹å¾)  â”‚    â”‚ (å›¾åŒæ„ç½‘ç»œ)     â”‚    â”‚ (å¯¹æ¯”å­¦ä¹ )      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    èŠ‚ç‚¹åµŒå…¥è¡¨ç¤º (128ç»´)

ç¬¬äºŒé˜¶æ®µï¼šç›‘ç£åˆ†ç±»æ£€æµ‹
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   èŠ‚ç‚¹åµŒå…¥      â”‚â”€â”€â”€â–¶â”‚   ç‰¹å¾æ‹¼æ¥       â”‚â”€â”€â”€â–¶â”‚  éšæœºæ£®æ—åˆ†ç±»å™¨  â”‚
â”‚   (128ç»´)       â”‚    â”‚(åµŒå…¥+åŸå§‹ç‰¹å¾)   â”‚    â”‚ (äºŒåˆ†ç±»)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯ç‰¹ç‚¹

- **GINç¼–ç å™¨**ï¼šå…·æœ‰1-WLåŒæ„åˆ¤åˆ«èƒ½åŠ›ï¼Œèƒ½åŒºåˆ†ä¸åŒæ‹“æ‰‘ç»“æ„çš„å­å›¾
- **ä¸¤è·³é‚»å±…é‡‡æ ·**ï¼šæ‰©å¤§æ„Ÿå—é‡ï¼Œé¿å…è¿‡æ·±ç½‘ç»œå¸¦æ¥çš„è¿‡æ‹Ÿåˆ
- **å¯¹æ¯”å­¦ä¹ æœºåˆ¶**ï¼šé€šè¿‡ç‰¹å¾æ‰°åŠ¨ç”Ÿæˆè´Ÿæ ·æœ¬ï¼Œæœ€å¤§åŒ–å±€éƒ¨-å…¨å±€äº’ä¿¡æ¯
- **ç‰¹å¾èåˆ**ï¼šç»“åˆå›¾ç»“æ„ä¿¡æ¯(åµŒå…¥)å’ŒåŸå§‹èŠ‚ç‚¹å±æ€§

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.8+
- PyTorch 2.0+
- PyTorch Geometric
- scikit-learn
- pandas, numpy

### å®‰è£…ä¾èµ–

```bash
pip install torch torch-geometric scikit-learn pandas numpy
```

### æ•°æ®å‡†å¤‡

å°†Ellipticæ•°æ®é›†æ”¾åœ¨`data/raw/`ç›®å½•ä¸‹ï¼š
- `elliptic_txs_classes.csv` - äº¤æ˜“ç±»åˆ«æ ‡ç­¾
- `elliptic_txs_edgelist.csv` - äº¤æ˜“è¾¹åˆ—è¡¨
- `elliptic_txs_features.csv` - äº¤æ˜“ç‰¹å¾

### è®­ç»ƒæ¨¡å‹

#### ä¸¤é˜¶æ®µè®­ç»ƒï¼ˆæ¨èï¼‰

```bash
# åŸºç¡€è®­ç»ƒï¼ˆ100è½®DGIé¢„è®­ç»ƒï¼‰
python3 run.py --mode gnn_dgi_rf --dgi_epochs 100

# å¸¦è¶…å‚æ•°è°ƒä¼˜çš„è®­ç»ƒ
python3 run.py --mode gnn_dgi_rf --dgi_epochs 100 --rf_hyperparameter_tuning

# è‡ªå®šä¹‰å‚æ•°è®­ç»ƒ
python3 run.py --mode gnn_dgi_rf \
  --dgi_epochs 150 \
  --hidden_channels 256 \
  --gnn_layers 4 \
  --rf_n_estimators 300 \
  --experiment_name custom_experiment
```

#### æ¨¡å‹è¯„ä¼°

```bash
python3 run.py --mode eval
```

#### æ¨ç†é¢„æµ‹

```bash
python3 run.py --mode inference
```

## ğŸ“Š æ¨¡å‹é…ç½®

### æ ¸å¿ƒå‚æ•°

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `num_features` | 165 | è¾“å…¥ç‰¹å¾ç»´åº¦ |
| `hidden_channels` | 128 | GINéšè—å±‚ç»´åº¦ |
| `gnn_layers` | 3 | GINå±‚æ•° |
| `dgi_epochs` | 100 | DGIé¢„è®­ç»ƒè½®æ•° |
| `rf_n_estimators` | 200 | éšæœºæ£®æ—æ ‘æ•°é‡ |
| `rf_max_depth` | 15 | éšæœºæ£®æ—æœ€å¤§æ·±åº¦ |

### è®­ç»ƒå‚æ•°

```bash
python3 run.py --mode gnn_dgi_rf \
  --epochs 200 \           # æ€»è®­ç»ƒè½®æ•°
  --batch_size 64 \         # æ‰¹æ¬¡å¤§å°
  --lr 0.001 \              # å­¦ä¹ ç‡
  --patience 20 \           # æ—©åœè€å¿ƒå€¼
  --device cuda \            # ä½¿ç”¨GPU
  --checkpoint_dir checkpoints \  # æ¨¡å‹ä¿å­˜ç›®å½•
  --experiment_name experiment_001   # å®éªŒåç§°
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
Blockchain_AML_SYS/
â”œâ”€â”€ data/                   # æ•°æ®å¤„ç†æ¨¡å—
â”‚   â”œâ”€â”€ data_loader.py      # æ•°æ®åŠ è½½å™¨
â”‚   â”œâ”€â”€ feature_engineering.py  # ç‰¹å¾å·¥ç¨‹
â”‚   â””â”€â”€ raw/               # åŸå§‹æ•°æ®
â”œâ”€â”€ models/                 # æ¨¡å‹å®šä¹‰
â”‚   â”œâ”€â”€ dgi.py            # DGI+GINæ¨¡å‹
â”‚   â”œâ”€â”€ two_stage_dgi_rf.py  # ä¸¤é˜¶æ®µè®­ç»ƒæ¨¡å‹
â”‚   â”œâ”€â”€ random_forest_classifier.py  # éšæœºæ£®æ—åˆ†ç±»å™¨
â”‚   â””â”€â”€ trainer.py        # è®­ç»ƒå™¨
â”œâ”€â”€ api/                    # REST APIæœåŠ¡
â”‚   â”œâ”€â”€ app.py            # Flaskåº”ç”¨
â”‚   â”œâ”€â”€ controllers/      # æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ routes.py         # è·¯ç”±å®šä¹‰
â”‚   â””â”€â”€ schemas/          # æ•°æ®éªŒè¯
â”œâ”€â”€ checkpoints/            # æ¨¡å‹æ£€æŸ¥ç‚¹
â”œâ”€â”€ logs/                   # è®­ç»ƒæ—¥å¿—
â””â”€â”€ run.py                 # ä¸»è®­ç»ƒè„šæœ¬
```

## ğŸ”§ APIæœåŠ¡

### å¯åŠ¨APIæœåŠ¡

```bash
cd api
python app.py
```

### APIç«¯ç‚¹

- `GET /api/v1/health` - å¥åº·æ£€æŸ¥
- `POST /api/v1/predict` - é¢„æµ‹æŒ‡å®šäº¤æ˜“
- `POST /api/v1/batch_predict` - æ‰¹é‡é¢„æµ‹
- `GET /api/v1/model/info` - è·å–æ¨¡å‹ä¿¡æ¯
- `GET /api/v1/statistics` - ç³»ç»Ÿç»Ÿè®¡

### ä½¿ç”¨ç¤ºä¾‹

```python
import requests

# å¥åº·æ£€æŸ¥
response = requests.get('http://localhost:5000/api/v1/health')

# é¢„æµ‹äº¤æ˜“
data = {'tx_ids': ['tx1', 'tx2', 'tx3']}
response = requests.post(
    'http://localhost:5000/api/v1/predict',
    json=data
)
```

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### è¯„ä¼°æŒ‡æ ‡

- **AUC-ROC**: å—è¯•è€…å·¥ä½œç‰¹å¾æ›²çº¿ä¸‹é¢ç§¯
- **AUC-PR**: ç²¾ç¡®ç‡-å¬å›ç‡æ›²çº¿ä¸‹é¢ç§¯
- **Accuracy**: å‡†ç¡®ç‡
- **Precision**: ç²¾ç¡®ç‡
- **Recall**: å¬å›ç‡
- **F1-Score**: F1åˆ†æ•°

### å…¸å‹ç»“æœ

åœ¨Ellipticæ•°æ®é›†ä¸Šçš„æ€§èƒ½ï¼š
- éªŒè¯AUC: 0.85-0.90
- éªŒè¯AP: 0.75-0.85
- å‡†ç¡®ç‡: 80-85%

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„å›¾ç¼–ç å™¨

1. åœ¨`models/dgi.py`ä¸­æ‰©å±•`GINEncoder`ç±»
2. ä¿®æ”¹`DGIWithGIN`ä»¥æ”¯æŒæ–°ç¼–ç å™¨
3. æ›´æ–°é…ç½®å‚æ•°

### è‡ªå®šä¹‰æŸå¤±å‡½æ•°

1. åœ¨`models/dgi.py`ä¸­ä¿®æ”¹`compute_dgi_loss`æ–¹æ³•
2. å®ç°æ–°çš„å¯¹æ¯”å­¦ä¹ ç­–ç•¥
3. è°ƒæ•´åˆ¤åˆ«å™¨ç»“æ„

### æ‰©å±•ç‰¹å¾å·¥ç¨‹

1. åœ¨`data/feature_engineering.py`ä¸­æ·»åŠ æ–°ç‰¹å¾
2. æ›´æ–°`data/__init__.py`ä¸­çš„æ•°æ®åŠ è½½æµç¨‹
3. è°ƒæ•´`num_features`å‚æ•°

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: è®­ç»ƒæ—¶å‡ºç°CUDAå†…å­˜ä¸è¶³**
```bash
# å‡å°æ‰¹æ¬¡å¤§å°
python3 run.py --mode gnn_dgi_rf --batch_size 32
```

**Q: æ¨¡å‹æ”¶æ•›é€Ÿåº¦æ…¢**
```bash
# å¢åŠ å­¦ä¹ ç‡æˆ–ä½¿ç”¨å­¦ä¹ ç‡è°ƒåº¦å™¨
python3 run.py --mode gnn_dgi_rf --lr 0.01 --scheduler cosine
```

**Q: éªŒè¯é›†æ€§èƒ½ä¸ä½³**
```bash
# å¯ç”¨è¶…å‚æ•°è°ƒä¼˜
python3 run.py --mode gnn_dgi_rf --rf_hyperparameter_tuning
```

### æ—¥å¿—åˆ†æ

è®­ç»ƒæ—¥å¿—ä¿å­˜åœ¨`logs/`ç›®å½•ä¸‹ï¼š
- `training_*.log` - è®­ç»ƒè¿‡ç¨‹æ—¥å¿—
- `model_training.log` - æ¨¡å‹è®­ç»ƒæ—¥å¿—

```bash
# æŸ¥çœ‹æœ€æ–°è®­ç»ƒæ—¥å¿—
tail -f logs/training_$(date +%Y%m%d)_*.log
```

## ğŸ“š å‚è€ƒæ–‡çŒ®

1. **Deep Graph Infomax** - Velickovic et al., ICLR 2019
2. **How Powerful are Graph Neural Networks?** - Xu et al., ICLR 2019
3. **Elliptic Data Set** - Webb et al., KDD 2019

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- æäº¤ Issue
- å‘é€é‚®ä»¶è‡³é¡¹ç›®ç»´æŠ¤è€…

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™å®ƒä¸€ä¸ªæ˜Ÿæ ‡ï¼